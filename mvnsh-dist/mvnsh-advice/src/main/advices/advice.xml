<?xml version="1.0" encoding="UTF-8"?>

<assembly>
    <advices>

        <advice>
            <appliesTo>
                <includes>
                    <include>org.sonatype.maven.shell.dist:mvnsh-resources</include>
                </includes>
            </appliesTo>
            <unit>
                <touchpoint id='org.sonatype.tycho.p2.touchpoint' version='0.1.0'/>
                <touchpointData>
                    <instructions>
                        <instruction key='install'>
                            natives:unzip( source:${artifact.location}, target:${installFolder}/, exclude:META-INF/** );
                            generic:chmod( targetDir:${installFolder}, targetFile:bin/mvn, permissions:755 );
                            generic:chmod( targetDir:${installFolder}, targetFile:bin/mvnsh, permissions:755 );
                        </instruction>
                        <instruction key='uninstall'>
                            natives:cleanupzip( source:${artifact.location},target:${installFolder}/ );
                        </instruction>
                    </instructions>
                </touchpointData>
            </unit>
        </advice>

        <advice>
            <appliesTo>
                <includes>
                    <include>org.sonatype.maven.shell:mvnsh-bootstrap</include>
                </includes>
            </appliesTo>
            <unit>
                <touchpoint id='org.sonatype.tycho.p2.touchpoint' version='0.1.0'/>
                <touchpointData>
                    <instructions>
                        <instruction key='install'>
                            natives:copy( source:${artifact.location}, target:${installFolder}/boot/bootstrap.jar );
                        </instruction>
                        <instruction key='uninstall'>
                            natives:cleanupcopy( source:${artifact.location}, target:${installFolder}/boot/bootstrap.jar );
                        </instruction>
                    </instructions>
                </touchpointData>
            </unit>
        </advice>

        <advice>
            <appliesTo>
                <includes>
                    <include>org.sonatype.maven.shell:mvnsh-personality</include>
                    <include>org.sonatype.gshell:gshell-gossip</include>
                    <include>org.sonatype.gshell.commands:gshell-standard</include>
                </includes>
            </appliesTo>
            <appliesTransitively>true</appliesTransitively>
            <unit>
                <touchpoint id='org.sonatype.tycho.p2.touchpoint' version='0.1.0'/>
                <touchpointData>
                    <instructions>
                        <instruction key='install'>
                            natives:copy( source:${artifact.location}, target:${installFolder}/lib/${maven:fileName} );
                        </instruction>
                        <instruction key='uninstall'>
                            natives:cleanupcopy( source:${artifact.location}, target:${installFolder}/lib/${maven:fileName} );
                        </instruction>
                    </instructions>
                </touchpointData>
            </unit>
        </advice>

        <advice>
            <appliesTo>
                <includes>
                    <include>org.sonatype.gshell.dist:gshell-commands-basic</include>
                    <include>org.sonatype.maven.shell.dist:mvnsh-commands</include>
                </includes>
            </appliesTo>
            <appliesTransitively>true</appliesTransitively>
            <appliesToSelf>false</appliesToSelf>
            <unit>
                <touchpoint id='org.sonatype.tycho.p2.touchpoint' version='0.1.0'/>
                <touchpointData>
                    <instructions>
                        <instruction key='install'>
                            natives:copy( source:${artifact.location}, target:${installFolder}/lib/${maven:fileName} );
                        </instruction>
                        <instruction key='uninstall'>
                            natives:cleanupcopy( source:${artifact.location}, target:${installFolder}/lib/${maven:fileName} );
                        </instruction>
                    </instructions>
                </touchpointData>
            </unit>
        </advice>

    </advices>
</assembly>  